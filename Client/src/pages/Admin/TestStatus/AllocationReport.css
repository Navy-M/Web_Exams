/* =========================================================
   NeoMarine UI â€” polished theme for Allocation & Quotas
   - Light/Dark tokens
   - Better tables (sticky header, zebra, hover)
   - Refined buttons/inputs/sliders
   - Clean modal
   - Print-safe
   - RTL-friendly
========================================================= */

/* ---------- CSS Vars (theme tokens) ---------- */
:root{
  --bg: var(--background-light, #ffffff);
  --bg-elev: #f8fafc;
  --bg-elev-2: #eef2f7;
  --text: var(--text-light, #0f172a);
  --muted: #64748b;

  --primary: var(--primary-color, #2563eb);
  --primary-2: var(--secondary-color, #4f46e5);
  --primary-3: #22c55e;

  --border: var(--border-light, #e2e8f0);
  --border-subtle: #edf2f7;
  --ring: #93c5fd;

  --shadow: 0 10px 28px rgba(2, 6, 23, 0.06);
  --shadow-sm: 0 6px 16px rgba(2, 6, 23, 0.05);
  --shadow-lg: 0 18px 42px rgba(2, 6, 23, 0.08);

  --r: 14px; /* base radius */
  --r-sm: 10px;
  --kpi-grad: linear-gradient(135deg, rgba(37,99,235,.08), rgba(79,70,229,.08));
}

@media (prefers-color-scheme: dark){
  :root {
    --bg: #0b0f19;
    --bg-elev: #0f172a;
    --bg-elev-2: #111827;
    --text: #e5e7eb;
    --muted: #94a3b8;
    --border: #1f2937;
    --border-subtle: #111827;
    --ring: #3b82f6;
    --shadow: 0 10px 28px rgba(0,0,0,.35);
    --shadow-sm: 0 6px 18px rgba(0,0,0,.25);
    --shadow-lg: 0 22px 56px rgba(0,0,0,.45);
  }
}

[data-theme="dark"]{
  --bg: #0b0f19;
  --bg-elev: #0f172a;
  --bg-elev-2: #111827;
  --text: #e5e7eb;
  --muted: #94a3b8;
  --border: #1f2937;
  --border-subtle: #111827;
  --ring: #3b82f6;
  --shadow: 0 10px 28px rgba(0,0,0,.35);
  --shadow-sm: 0 6px 18px rgba(0,0,0,.25);
  --shadow-lg: 0 22px 56px rgba(0,0,0,.45);
}

/* ---------- Base ---------- */
* { box-sizing: border-box; }
html, body { background: var(--bg); color: var(--text); }
[dir="rtl"] { text-align: right; }
.muted { color: var(--muted); }
.small { font-size: 12px; }

/* ---------- Card wrappers ---------- */
.allocation-report{
  background: var(--bg-elev);
  border: 1px solid var(--border);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 1rem;
}
.allocation-container{
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow-sm);
  padding: 1rem;
}

/* ---------- Header ---------- */
.allocation-header{
  display:flex; align-items:center; justify-content:space-between;
  gap:.8rem; margin-bottom:.8rem;
}
.allocation-title{ margin:0; color: var(--primary); letter-spacing:-.2px; }
.allocation-sub{ margin-top:.15rem; }

.allocation-actions{ display:flex; gap:.5rem; flex-wrap: wrap; }

/* ---------- Buttons ---------- */
.btn{
  display:inline-flex; align-items:center; gap:.5rem;
  padding:.55rem .9rem; border-radius: 12px; border:1px solid var(--border);
  background: var(--bg); color: var(--text); cursor: pointer;
  transition: transform .15s ease, box-shadow .2s ease, border-color .15s ease, background .15s ease;
  outline: none;
}
.btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow); }
.btn:focus-visible{ box-shadow: 0 0 0 3px var(--ring); border-color: transparent; }
.btn:active{ transform: translateY(0); box-shadow: var(--shadow-sm); }

.btn.primary{
  background: linear-gradient(135deg, var(--primary), var(--primary-2));
  color: #fff; border-color: transparent;
}
.btn.primary:hover{ box-shadow: var(--shadow-lg); }
.btn.outline{ background: transparent; border-color: var(--primary); color: var(--primary); }

/* Ghost */
.btn.ghost{
  background: transparent; border-color: var(--border); color: var(--text);
}
.btn.ghost:hover{ background: var(--bg-elev); }

/* ---------- KPI / Summary ---------- */
.rep-summary{ margin-bottom:.9rem; }
.sum-grid{
  display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:.6rem;
}
.sum-item{
  background: var(--kpi-grad);
  border:1px solid var(--border);
  border-radius: 12px;
  padding:.7rem .9rem;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.4);
}

/* ---------- Tables (allocations & totals) ---------- */
.allocation-table,
.totals-table{
  width: 100%; border-collapse: separate; border-spacing: 0;
  border:1px solid var(--border); border-radius: 12px; overflow: hidden;
}

/* Sticky head on long lists */
.allocation-table thead th,
.totals-table thead th{
  position: sticky; top: 0; z-index: 1;
  background: color-mix(in oklab, var(--primary) 10%, transparent);
  color: var(--text);
  font-weight: 800;
  padding: 12px 12px;
  border-bottom: 1px solid var(--border);
}
.allocation-table th, .allocation-table td,
.totals-table th, .totals-table td{
  padding: 10px 12px; border-bottom: 1px solid var(--border-subtle); text-align:center;
  font-variant-numeric: tabular-nums;
}
.allocation-table tbody tr:nth-child(even) td,
.totals-table tbody tr:nth-child(even) td{
  background: color-mix(in srgb, var(--bg-elev) 70%, transparent);
}
.allocation-table tbody tr:hover td{
  background: color-mix(in oklab, var(--primary) 6%, transparent);
}

/* Group header row */
.group-row th{
  background: color-mix(in oklab, var(--primary) 14%, var(--bg));
  color:#0b1020; text-align:right; font-size: 1rem;
  border-bottom: 1px solid var(--border);
}
[data-theme="dark"] .group-row th{
  color: #e5e7eb;
}

/* Badges */
.badge{
  display:inline-block; border:1px solid var(--border); border-radius:999px;
  padding:.15rem .55rem; font-size:.8rem; color: var(--muted); background: var(--bg);
  margin-inline-start:.4rem;
}
.badge.ok { background:#dcfce7; color:#166534; border-color: #a7f3d0; }
.badge.warn { background:#fff7ed; color:#9a3412; border-color: #fed7aa; }

/* Totals table spacing */
.totals-table{ margin-bottom: .9rem; }

/* ---------- Unassigned ---------- */
.rep-unassigned{ margin-top: .9rem; }
.unassigned-box{
  background: var(--bg-elev);
  border: 1px dashed var(--border);
  border-radius: 12px;
  padding:.7rem .9rem; color: var(--text);
}

/* ---------- Modal (Quotas & Criteria) ---------- */
.ts-modal-overlay{
  position: fixed; inset:0; display:flex; align-items:center; justify-content:center;
  background: rgba(2,6,23,.45); backdrop-filter: blur(4px);-webkit-backdrop-filter:blur(4px); z-index: 1000;
  padding: 1rem;
}
.ts-modal{
  max-width: 980px; width: min(96%, 980px);
  background: var(--bg);
  border:1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow-lg);
  padding: 16px;
}
.ts-modal-block{ margin: 14px 0; }
.ts-modal-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:16px; }

/* Inputs */
.ts-modal select,
.ts-modal input[type="number"],
.ts-modal input[type="text"]{
  appearance: none;
  background: var(--bg-elev);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: .5rem .6rem;
  min-height: 38px;
  outline: none;
  transition: border-color .15s, box-shadow .15s, background .15s;
}
.ts-modal select:focus,
.ts-modal input[type="number"]:focus,
.ts-modal input[type="text"]:focus{
  border-color: var(--primary);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary) 25%, transparent);
}

/* Grid for quotas */
.ts-modal-grid{
  display: grid; grid-template-columns: repeat(auto-fill, minmax(240px,1fr));
  gap: 10px; align-items: center;
}
.quota-row{ display: contents; }
.quota-row label{ grid-column: span 1; align-self: center; }
.quota-row input{ grid-column: span 1; }

/* Criteria table */
.criteria-table-wrap{
  overflow:auto; border:1px solid var(--border); border-radius:12px; background: var(--bg-elev);
}
.criteria-table{
  width:100%; border-collapse: separate; border-spacing: 0; min-width: 760px;
}
.criteria-table th{
  position: sticky; top:0; z-index:1;
  background: color-mix(in oklab, var(--primary) 10%, transparent);
  border-bottom: 1px solid var(--border); padding:10px; font-weight:800;
}
.criteria-table td{ border-bottom:1px solid var(--border); padding:8px; text-align:center; }
.criteria-table tbody tr:nth-child(even) td{ background: color-mix(in srgb, var(--bg), var(--bg-elev) 60%); }

/* Range slider (weights) */
.criteria-table input[type="range"]{
  width: 200px; height: 6px; appearance: none; background: var(--border); border-radius: 999px; outline: none;
}
.criteria-table input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance: none; appearance: none;
  width: 16px; height:16px; border-radius:50%;
  background: var(--primary); border: 2px solid #fff; box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary) 35%, transparent);
  cursor: pointer;
}
.criteria-table input[type="range"]::-moz-range-thumb{
  width: 16px; height:16px; border-radius:50%; background: var(--primary); border:2px solid #fff;
}

/* Checkbox nicer */
.criteria-table input[type="checkbox"]{
  width: 18px; height:18px; cursor: pointer; accent-color: var(--primary);
}

/* Utility rows */
.row { display:flex; align-items:center; }
.gap8 { gap:8px; }
.gap12 { gap:12px; }
.align-center { align-items:center; }
.center { text-align:center; }

/* ---------- Print ---------- */
@media print {
  .allocation-actions, .allocation-header, .ts-modal-overlay { display: none !important; }
  .allocation-report, .allocation-container { border: none; box-shadow: none; padding: 0; }
  .sum-item, .unassigned-box { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  .allocation-table thead th,
  .totals-table thead th,
  .criteria-table th { position: static; } /* no sticky in print */
}

/* ---------- Responsive ---------- */
@media (max-width: 960px){
  .sum-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}
@media (max-width: 720px){
  .sum-grid{ grid-template-columns: 1fr; }
  .allocation-header{ flex-direction: column; align-items: flex-start; }
  .allocation-actions{ width: 100%; }
}

/* ---------- Motion safety ---------- */
@media (prefers-reduced-motion: reduce){
  .btn, .allocation-table tbody tr:hover td { transition: none !important; }
}

/* ---------- Extras (chips + progress if you want) ---------- */
.chip{
  display:inline-flex; align-items:center; gap:.4rem;
  background: var(--bg-elev); border:1px solid var(--border); color: var(--text);
  padding:.25rem .6rem; border-radius:999px; font-size: .8rem;
}
.progress{
  width: 100%; height: 8px; border-radius: 999px; background: var(--border);
  overflow: hidden;
}
.progress > span{
  display:block; height:100%; background: linear-gradient(90deg, var(--primary), var(--primary-2));
  width: var(--value, 0%); transition: width .25s ease;
}
